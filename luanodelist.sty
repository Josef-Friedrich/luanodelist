\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{luanodelist}
\RequirePackage{luatexbase-mcb}
\RequirePackage{kvoptions}

\SetupKeyvalOptions{
  family=LN,
  prefix=LN@
}
\DeclareStringOption[term and log]{channel}
\DeclareStringOption[postlinebreak]{callback}
\DeclareStringOption[1]{verbosity}
\DeclareStringOption[guided]{interface}

\ProcessKeyvalOptions*

\newcommand{\setluanodelist}[1]{\setkeys{LN}{#1}}

\directlua{
  options = {}
  options.verbosity = tonumber(\LN@verbosity)
  options.channel = '\LN@channel'
  options.callback = '\LN@callback'
  options.interface = '\LN@interface'


  package.path = './lua/?.lua;' .. package.path
  colors = require("ansicolors")
  template = require("template")

  if options.interface == "guided" then
    require("guided")
  else
    require("automatic")
  end

  register_callback()

}
