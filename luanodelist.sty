\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{luanodelist}
\RequirePackage{luatexbase-mcb}

\DeclareOption{log}{\directlua{output_way = 'log'}}
\DeclareOption{term}{\directlua{output_way = 'term'}}
\DeclareOption{termandlog}{\directlua{output_way = 'term and log'}}

\ProcessOptions\relax

\directlua{
  require("luanodelist")

  inspector = function(head)
    luanodelist.nodelist_visualize(head)
    return true
  end

  luatexbase.add_to_callback("post_linebreak_filter", inspector, "inspector")
}
